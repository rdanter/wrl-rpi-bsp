From 530d2df60345819a6a836dc82522b68d9cd3db0d Mon Sep 17 00:00:00 2001
From: Dom Cobley <popcornmix@gmail.com>
Date: Fri, 22 Jul 2022 11:00:20 +0100
Subject: [PATCH] Revert "tty: amba-pl011: Add un/throttle support"

This reverts commit 159f4c6402fadc30c984cc13e6e19e7d233a77b9.
---
 drivers/tty/serial/amba-pl011.c | 28 ----------------------------
 1 file changed, 28 deletions(-)

diff --git a/drivers/tty/serial/amba-pl011.c b/drivers/tty/serial/amba-pl011.c
index 9d25bcfc5057..706767bd48a1 100644
--- a/drivers/tty/serial/amba-pl011.c
+++ b/drivers/tty/serial/amba-pl011.c
@@ -1360,32 +1360,6 @@ static void pl011_start_tx(struct uart_port *port)
 		pl011_start_tx_pio(uap);
 }
 
-static void pl011_throttle(struct uart_port *port)
-{
-	struct uart_amba_port *uap =
-	    container_of(port, struct uart_amba_port, port);
-	unsigned long flags;
-
-	spin_lock_irqsave(&uap->port.lock, flags);
-	uap->im &= ~(UART011_RTIM | UART011_RXIM);
-	pl011_write(uap->im, uap, REG_IMSC);
-	spin_unlock_irqrestore(&uap->port.lock, flags);
-}
-
-static void pl011_unthrottle(struct uart_port *port)
-{
-	struct uart_amba_port *uap =
-	    container_of(port, struct uart_amba_port, port);
-	unsigned long flags;
-
-	spin_lock_irqsave(&uap->port.lock, flags);
-	uap->im |= UART011_RTIM;
-	if (!pl011_dma_rx_running(uap))
-	    uap->im |= UART011_RXIM;
-	pl011_write(uap->im, uap, REG_IMSC);
-	spin_unlock_irqrestore(&uap->port.lock, flags);
-}
-
 static void pl011_stop_rx(struct uart_port *port)
 {
 	struct uart_amba_port *uap =
@@ -2293,8 +2267,6 @@ static const struct uart_ops amba_pl011_pops = {
 	.stop_tx	= pl011_stop_tx,
 	.start_tx	= pl011_start_tx,
 	.stop_rx	= pl011_stop_rx,
-	.throttle	= pl011_throttle,
-	.unthrottle	= pl011_unthrottle,
 	.enable_ms	= pl011_enable_ms,
 	.break_ctl	= pl011_break_ctl,
 	.startup	= pl011_startup,
-- 
2.32.0

