From 54741bdf8d8c18c4d5b861c4a0003502ef53b075 Mon Sep 17 00:00:00 2001
From: Dom Cobley <popcornmix@gmail.com>
Date: Thu, 27 Jan 2022 14:31:21 +0000
Subject: [PATCH 1347/2201] Revert "vc4/drm: SQUASH: Fix source offsets with
 DRM_FORMAT_P030"

This reverts commit d1fd8a5727908bb677c003d2ae977e9d935a6f94.
---
 drivers/gpu/drm/vc4/vc4_plane.c | 5 ++---
 1 file changed, 2 insertions(+), 3 deletions(-)

diff --git a/drivers/gpu/drm/vc4/vc4_plane.c b/drivers/gpu/drm/vc4/vc4_plane.c
index 074bdfdb184c..60a38bb13024 100644
--- a/drivers/gpu/drm/vc4/vc4_plane.c
+++ b/drivers/gpu/drm/vc4/vc4_plane.c
@@ -864,9 +864,8 @@ static int vc4_plane_mode_set(struct drm_plane *plane,
 			 * and bits[3:0] should be between 0 and 11, indicating which
 			 * of the 12-pixels in that 128-bit word is the first pixel to be used
 			 */
-	                u32 remaining_pixels = vc4_state->src_x % 96;
-			u32 aligned = remaining_pixels / 12;
-			u32 last_bits = remaining_pixels % 12;
+			u32 aligned = vc4_state->src_x / 12;
+			u32 last_bits = vc4_state->src_x % 12;
 
 			x_off = aligned * 16 + last_bits;
 			hvs_format = HVS_PIXEL_FORMAT_YCBCR_10BIT;
-- 
2.17.1

